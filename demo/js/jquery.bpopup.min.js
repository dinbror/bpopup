/*================================================================================
 * @name: bPopup - if you can't get it up, use bPopup
 * @author: (c)Bjoern Klinggaard (twitter@bklinggaard)
 * @demo: http://dinbror.dk/bpopup
 * @version: 0.11.0.min
 ================================================================================*/
 !function(o){"use strict";o.fn.bPopup=function(t,n){function e(){w(T.onOpen),M=(j.data("bPopup")||0)+1,y=O+M+"__",v="auto"!==T.position[1],P="auto"!==T.position[0],U="fixed"===T.positionStyle,z=_.outerHeight(!0),B=_.outerWidth(!0),T.loadUrl?i():a()}function i(){switch(T.contentContainer=o(T.contentContainer||_),T.content){case"iframe":var t=o('<iframe class="b-iframe" '+T.iframeAttr+"></iframe>");t.appendTo(T.contentContainer),z=_.outerHeight(!0),B=_.outerWidth(!0),a(),t.attr("src",T.loadUrl),w(T.loadCallback);break;case"image":a(),o("<img />").load(function(){w(T.loadCallback),d(o(this))}).attr("src",T.loadUrl).hide().appendTo(T.contentContainer);break;default:a(),o('<div class="b-ajax-wrapper"></div>').load(T.loadUrl,T.loadData,function(t,n){w(T.loadCallback,n),d(o(this))}).hide().appendTo(T.contentContainer)}}function a(){T.modal&&o('<div class="b-modal '+y+'"></div>').css({backgroundColor:T.modalColor,position:"fixed",top:0,right:0,bottom:0,left:0,opacity:0,zIndex:T.zIndex+M}).appendTo(T.appendTo).fadeTo(T.speed,T.opacity),m(),_.data("bPopup",T).data("id",y).css({left:"slideIn"==T.transition||"slideBack"==T.transition?"slideBack"==T.transition?D.scrollLeft()+E:-1*(S+B):h(!(!T.follow[0]&&P||U)),position:T.positionStyle||"absolute",top:"slideDown"==T.transition||"slideUp"==T.transition?"slideUp"==T.transition?D.scrollTop()+A:I+-1*z:b(!(!T.follow[1]&&v||U)),"z-index":T.zIndex+M+1}).each(function(){T.appending&&o(this).appendTo(T.appendTo)}),f(!0)}function l(){return T.modal&&o(".b-modal."+_.data("id")).fadeTo(T.speed,0,function(){o(this).remove()}),u(),clearTimeout(W),f(),!1}function s(){l(),Q=!0}function c(t){A=g(),E=k(),x=C(),(x.x||x.y)&&(clearTimeout(H),H=setTimeout(function(){m(),t=t||T.followSpeed;var n={};x.x&&(n.left=T.follow[0]?h(!0):"auto"),x.y&&(n.top=T.follow[1]?b(!0):"auto"),_.dequeue().each(function(){U?o(this).css({left:S,top:I}):o(this).animate(n,t,T.followEasing)})},50))}function d(o){var t=o.width(),n=o.height(),e={};T.contentContainer.css({height:n,width:t}),n>=_.height()&&(e.height=_.height()),t>=_.width()&&(e.width=_.width()),z=_.outerHeight(!0),B=_.outerWidth(!0),m(),T.contentContainer.css({height:"auto",width:"auto"}),e.left=h(!(!T.follow[0]&&P||U)),e.top=b(!(!T.follow[1]&&v||U)),_.animate(e,250,function(){o.show(),x=C()})}function r(){j.data("bPopup",M),_.delegate(".bClose, ."+T.closeClass,"click."+y,l),_.delegate("."+T.confirmClass,"click."+y,s),T.modalClose&&o(".b-modal."+y).css("cursor","pointer").bind("click",l),q||!T.follow[0]&&!T.follow[1]||j.bind("scroll."+y,function(){if(x.x||x.y){var o={};x.x&&(o.left=T.follow[0]?h(!U):"auto"),x.y&&(o.top=T.follow[1]?b(!U):"auto"),_.dequeue().animate(o,T.followSpeed,T.followEasing)}}).bind("resize."+y,function(){c()}),T.escClose&&D.bind("keydown."+y,function(o){27==o.which&&l()})}function u(){T.scrollBar||o("html").css("overflow","auto"),o(".b-modal."+y).unbind("click"),D.unbind("keydown."+y),j.unbind("."+y).data("bPopup",j.data("bPopup")-1>0?j.data("bPopup")-1:null),_.undelegate(".bClose, ."+T.closeClass,"click."+y,l).data("bPopup",null),_.undelegate("."+T.confirmClass,"click."+y,s).data("bPopup",null)}function f(o){function t(t){_.css({display:"block",opacity:1}).animate(t,T.speed,T.easing,function(){p(o)})}switch(o?T.transition:T.transitionClose||T.transition){case"slideIn":t({left:o?h(!(!T.follow[0]&&P||U)):D.scrollLeft()-(B||_.outerWidth(!0))-F});break;case"slideBack":t({left:o?h(!(!T.follow[0]&&P||U)):D.scrollLeft()+E+F});break;case"slideDown":t({top:o?b(!(!T.follow[1]&&v||U)):D.scrollTop()-(z||_.outerHeight(!0))-F});break;case"slideUp":t({top:o?b(!(!T.follow[1]&&v||U)):D.scrollTop()+A+F});break;default:_.stop().fadeTo(T.speed,o?1:0,function(){p(o)})}}function p(o){o?(r(),w(n),T.autoClose&&(W=setTimeout(l,T.autoClose))):(_.hide(),Q?(Q=!1,w(T.onConfirm)):w(T.onClose),T.loadUrl&&(T.contentContainer.empty(),_.css({height:"auto",width:"auto"})))}function h(o){return o?S+D.scrollLeft():S}function b(o){return o?I+D.scrollTop():I}function w(t,n){o.isFunction(t)&&t.call(_,n)}function m(){I=v?T.position[1]:Math.max(0,(A-_.outerHeight(!0))/2-T.amsl),S=P?T.position[0]:(E-_.outerWidth(!0))/2,x=C()}function C(){return{x:E>_.outerWidth(!0),y:A>_.outerHeight(!0)}}function g(){return j.height()}function k(){return j.width()}o.isFunction(t)&&(n=t,t=null);var T=o.extend({},o.fn.bPopup.defaults,t);T.scrollBar||o("html").css("overflow","hidden");var y,x,v,P,U,I,S,z,B,H,W,_=this,D=o(document),L=window,j=o(L),A=g(),E=k(),O="__b-popup",q=/OS 6(_\d)+/i.test(navigator.userAgent),F=200,M=0,Q=!1;return _.close=function(){l()},_.reposition=function(o){c(o)},_.each(function(){o(this).data("bPopup")||e()})},o.fn.bPopup.defaults={amsl:50,appending:!0,appendTo:"body",autoClose:!1,closeClass:"b-close",content:"ajax",contentContainer:!1,easing:"swing",escClose:!0,follow:[!0,!0],followEasing:"swing",followSpeed:500,iframeAttr:'scrolling="no" frameborder="0"',loadCallback:!1,loadData:!1,loadUrl:!1,modal:!0,modalClose:!0,modalColor:"#000",onClose:!1,onOpen:!1,opacity:.7,position:["auto","auto"],positionStyle:"absolute",scrollBar:!0,speed:250,transition:"fadeIn",transitionClose:!1,zIndex:9997,confirmClass:"b-confirm",onConfirm:!1}}(jQuery);